document.addEventListener('DOMContentLoaded', () => {
    const terminal = new Terminal();
    terminal.open(document.getElementById('term'));

    const files = ['file1.txt', 'file2.txt', 'directory1', 'directory2'];
    const folder = ['directory1', 'directory2'];
    let currentInput = '';
    terminal.write('Welcome to NetRunner!\r\n$ ');

    terminal.onKey(({ key, domEvent }) => {
        const char = key;

        if (domEvent.keyCode === 13) {  // Enter key
            terminal.writeln('');
            const command = currentInput.trim();
            switch (command) {
                case 'cd':
                    terminal.write('$ ' + currentInput);
                    if (currentInput + folder.join('\r\n') + '\r\n') {
                        terminal.write('\nUnknown command\r\n$ ');
                    } else {
                        terminal.write('\r\n$');
                    }                        
                    break;
                case 'cat':
                    terminal.write(files.open());
                    break;
                case 'ls':
                    terminal.write(files.join('\r\n') + '\r\n$ ');
                    break;
                case 'help':
                    terminal.write('Commands:\r\nls - List files\r\nhelp - Show this help message\r\n$ ');
                    break;
                default:
                    terminal.write('Unknown command\r\n$ ');
                    break;
            }
            currentInput = '';
        } else if (domEvent.keyCode === 8) {
            // Backspace 처리
            if (currentInput.length > 0) {
                terminal.write('\b \b'); // 터미널에서 문자를 제거
                currentInput = currentInput.slice(0, -1);
            }
        } else {
            currentInput += char;
            terminal.write(char);
        }
    });
});
